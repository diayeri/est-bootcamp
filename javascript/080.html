<!DOCTYPE html>
<html lang="ko-KR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>XHR</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/prism.min.js"></script>
    <style></style>
  </head>
  <body>
    <main>
      <h1>XHR</h1>
      <pre><code class="language-javascript">
let result;
function xhrRequest() {
  const requestObj = new XMLHttpRequest(); // 1. 새로운 XHR 객체 생성
  requestObj.open("GET", "hello.txt"); // 2. 비동기 GET 요청 초기화
  // 3. 상태 변화 감지
  requestObj.onreadystatechange = () => {
    // readyState가 변화할 때마다 호출되는 이벤트 리스너를 설정
    // 요청이 완료되었고 (readyState === 4), 성공했을 때 (status === 200)
    if (requestObj.readyState === 4 && requestObj.status === 200) {
      // 응답 텍스트를 result에 저장하고 document.write(result)로 출력
      result = requestObj.responseText;
      // document.write(result);
      console.log(result);
    }
    // result를 콘솔에 출력
    console.log(result);
  };
  // 서버로 요청 전송
  requestObj.send();
}

xhrRequest();
      </code></pre>
    </main>
    <script src="../common.js"></script>
    <script>
      // # 기본 XHR 요청
      let result;
      function xhrRequest() {
        const requestObj = new XMLHttpRequest(); // 1. 새로운 XHR 객체 생성
        requestObj.open("GET", "hello.txt"); // 2. 비동기 GET 요청 초기화
        // 3. 상태 변화 감지
        requestObj.onreadystatechange = () => {
          // readyState가 변화할 때마다 호출되는 이벤트 리스너를 설정
          // 요청이 완료되었고 (readyState === 4), 성공했을 때 (status === 200)
          if (requestObj.readyState === 4 && requestObj.status === 200) {
            // 응답 텍스트를 result에 저장하고 document.write(result)로 출력
            result = requestObj.responseText;
            // document.write(result); // 여기서 document.write를 써버리면, 무한로딩에 빠짐
            console.log(result, typeof result);
          }
          // result를 콘솔에 출력
          console.log(result);
        };
        // 서버로 요청 전송
        requestObj.send();
      }

      xhrRequest();
    </script>
  </body>
</html>
